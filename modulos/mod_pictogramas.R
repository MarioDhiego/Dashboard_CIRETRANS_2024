
pictogramas_ui <- function(id) {
  
  fluidPage(
    navbarPage(
      title = "PICTOGRAMAS",
      tabPanel("Gráficos",
               fluidRow(
                 box(
                   width = 6,
                   title = "Pictograma Bicicleta",
                   status = "primary",
                   solidHeader = TRUE,
                   collapsible = TRUE,
                   height = 50,
                   div(class = "elemente",
                       echarts4rOutput(NS(id,"pictograma1"),
                                       width = "100%")
                   )
                 ),
                 box(
                   width = 6,
                   title = "Pictograma Automóvel",
                   status = "primary",
                   solidHeader = TRUE,
                   collapsible = TRUE,
                   height = 50,
                   div(class = "elemente",
                       echarts4rOutput(NS(id,"pictograma2"),
                                       width = "100%")
                   )
                 )
               )
      )
    )
  )
  
}
##########################################################################################
#Função do modulo servidor

pictogramas_Server <- function(id) {
  moduleServer(id, function(input, output, session) {
    

output$pictograma1 <- renderEcharts4r({
bici_icon <- "path://M12 23c-6.071 0-11-4.929-11-11s4.929-11 11-11 11 4.929 11 11-4.929 11-11 11zm0-23c-6.623 0-12 5.377-12 12s5.377 12 12 12 12-5.377 12-12-5.377-12-12-12zm-1.379 12.996c-.125-1.063-.704-2.004-1.599-2.601l.488-.962 1.639 3.563h-.528zm-3.621 3.215c-1.534 0-2.782-1.248-2.782-2.782s1.248-2.783 2.782-2.783c.292 0 .581.046.857.135l-.944 1.863c-.397.043-.703.38-.703.785 0 .435.355.789.79.789.266 0 .515-.136.661-.357h2.088c-.21 1.346-1.377 2.35-2.749 2.35zm.704-3.215l.924-1.824c.602.437 1.006 1.094 1.121 1.824h-2.045zm6.559-3.778l-2.426 3.206-1.478-3.206h3.904zm2.737 6.993c-1.534 0-2.782-1.248-2.782-2.782 0-.969.509-1.871 1.334-2.376l.797 1.93c-.09.132-.138.285-.138.446 0 .435.354.789.789.789.435 0 .789-.354.789-.789 0-.38-.272-.706-.641-.776l-.796-1.93c.21-.051.428-.077.648-.077 1.534 0 2.782 1.249 2.782 2.783 0 1.534-1.248 2.782-2.782 2.782zm0-6.429c-.333 0-.663.045-.98.134l-1.232-2.991h-1.717c-.242 0-.432.2-.432.432 0 .238.194.433.432.433h1.133l.237.564h-4.469l-.266-.564h.145c.243 0 .432-.198.432-.433 0-.239-.193-.432-.432-.432h-1.78c-.115 0-.224.045-.305.126-.082.082-.127.191-.127.306 0 .238.194.433.432.433h.683l.294.641-.797 1.572c-.399-.147-.82-.221-1.251-.221-2.011 0-3.646 1.636-3.646 3.647 0 2.01 1.635 3.646 3.646 3.646 1.86 0 3.405-1.377 3.621-3.214h1.216l3.15-4.174.232.56c-1.153.647-1.865 1.859-1.865 3.182 0 2.01 1.635 3.646 3.646 3.646s3.646-1.636 3.646-3.646c0-2.011-1.635-3.647-3.646-3.647z"

bicicleta <-"path://M8.141 11.624l-.653-.519c-.395-.312-.477-.878-.187-1.291l2.474-3.519c.237-.337.7-.42 1.04-.186l4.185 2.884h1.5c.31 0 .5.259.5.5 0 .276-.224.5-.5.5h-.728l1.3 2.393c.593-.248 1.244-.386 1.928-.386 2.76 0 5 2.24 5 5s-2.24 5-5 5-5-2.24-5-5c0-1.72.87-3.237 2.193-4.138l-1.563-2.877-2.541-.782-.872 1.309 2.287 2.948c.179.231.216.535.122.811-.338.994-1.201 3.429-1.567 4.398-.09.244-.351.38-.604.316l-.023-.006c-.286-.071-.46-.347-.42-.637.156-1.159.573-3.986.573-3.986l-2.659-2.109-.674.957c1.07.917 1.748 2.277 1.748 3.796 0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.883 0 1.712.229 2.433.632l.708-1.008zm-1.288 1.831c-.554-.291-1.185-.455-1.853-.455-2.208 0-4 1.792-4 4s1.792 4 4 4c2.207 0 4-1.792 4-4 0-1.18-.512-2.241-1.326-2.974l-1.779 2.529c.067.133.105.285.105.445 0 .552-.448 1-1 1s-1-.448-1-1 .448-1 1-1l.061.002 1.792-2.547zm9.821.292c-1.014.726-1.674 1.913-1.674 3.253 0 2.208 1.792 4 4 4s4-1.792 4-4-1.792-4-4-4c-.511 0-.998.096-1.447.27l1.483 2.731c.535.019.964.459.964.999 0 .552-.448 1-1 1s-1-.448-1-1c0-.194.056-.377.152-.53l-1.478-2.723zm-3.597-11.747c1.147 0 2.077.931 2.077 2.077 0 1.147-.93 2.077-2.077 2.077-1.146 0-2.077-.93-2.077-2.077 0-1.146.931-2.077 2.077-2.077z/></svg>"

carro <- "path://M11 11v-3h1.247c.882 0 1.235.297 1.828.909.452.465 1.925 2.091 1.925 2.091h-5zm-1-3h-2.243c-.688 0-1.051.222-1.377.581-.316.348-.895.948-1.506 1.671 1.719.644 4.055.748 5.126.748v-3zm14 5.161c0-2.823-2.03-3.41-2.794-3.631-1.142-.331-1.654-.475-3.031-.794-.55-.545-2.052-2.036-2.389-2.376l-.089-.091c-.666-.679-1.421-1.269-3.172-1.269h-7.64c-.547 0-.791.456-.254.944-.534.462-1.944 1.706-2.34 2.108-1.384 1.402-2.291 2.48-2.291 4.603 0 2.461 1.361 4.258 3.179 4.332.41 1.169 1.512 2.013 2.821 2.013 1.304 0 2.403-.838 2.816-2h6.367c.413 1.162 1.512 2 2.816 2 1.308 0 2.409-.843 2.82-2.01 1.934-.056 3.181-1.505 3.181-3.829zm-18 4.039c-.662 0-1.2-.538-1.2-1.2s.538-1.2 1.2-1.2 1.2.538 1.2 1.2-.538 1.2-1.2 1.2zm12 0c-.662 0-1.2-.538-1.2-1.2s.538-1.2 1.2-1.2 1.2.538 1.2 1.2-.538 1.2-1.2 1.2zm2.832-2.15c-.399-1.188-1.509-2.05-2.832-2.05-1.327 0-2.44.868-2.836 2.062h-6.328c-.396-1.194-1.509-2.062-2.836-2.062-1.319 0-2.426.857-2.829 2.04-.586-.114-1.171-1.037-1.171-2.385 0-1.335.47-1.938 1.714-3.199.725-.735 1.31-1.209 2.263-2.026.34-.291.774-.432 1.222-.43h5.173c1.22 0 1.577.385 2.116.892.419.393 2.682 2.665 2.682 2.665s2.303.554 3.48.895c.84.243 1.35.479 1.35 1.71 0 1.196-.396 1.826-1.168 1.888z"
      
bici <- data.frame(
  x=c("Belém", "Ananindeua", "Parauapebas", "Marabá", "Altamira", "Santarém", "Castanhal", "Redenção", "Itaituba", "Marituba", "Paragominas", "Canaão", "Barcarena", "Xinguara", "Bragança", "Benevides"),
  y=c("47", "46", "45", "37", "35", "35", "33", "31", "30", "28", "25", "25", "24", "23", "19", "17"))
      
      bici %>%
        e_charts(x) %>%
        e_pictorial(y, symbol=bicicleta,
                    symbolRepeat = TRUE,
                    symbolSize = c(20,20))%>% 
        e_theme("blue") %>%
        e_title("Vítima Fatal p/Acidentes de Trânsito, segundo Colissão com Bicicleta", 
                left='center') %>%
        e_color(color='black') %>%
        e_flip_coords() %>%
        e_legend(show=FALSE) %>%
        e_x_axis(splitLine=list(show=F)) %>%
        e_y_axis(splitLine=list(show=T)) %>%
        e_labels(fontSize=15, 
                 fontWeight='bold', 
                 position="right", 
                 offset=c(5, 0), 
                 color= "red") %>%
        e_tooltip()%>%
        e_animation(duration = 3000)
      
    })
    
    
output$pictograma2 <- renderEcharts4r({

bici_icon <- "path://M12 23c-6.071 0-11-4.929-11-11s4.929-11 11-11 11 4.929 11 11-4.929 11-11 11zm0-23c-6.623 0-12 5.377-12 12s5.377 12 12 12 12-5.377 12-12-5.377-12-12-12zm-1.379 12.996c-.125-1.063-.704-2.004-1.599-2.601l.488-.962 1.639 3.563h-.528zm-3.621 3.215c-1.534 0-2.782-1.248-2.782-2.782s1.248-2.783 2.782-2.783c.292 0 .581.046.857.135l-.944 1.863c-.397.043-.703.38-.703.785 0 .435.355.789.79.789.266 0 .515-.136.661-.357h2.088c-.21 1.346-1.377 2.35-2.749 2.35zm.704-3.215l.924-1.824c.602.437 1.006 1.094 1.121 1.824h-2.045zm6.559-3.778l-2.426 3.206-1.478-3.206h3.904zm2.737 6.993c-1.534 0-2.782-1.248-2.782-2.782 0-.969.509-1.871 1.334-2.376l.797 1.93c-.09.132-.138.285-.138.446 0 .435.354.789.789.789.435 0 .789-.354.789-.789 0-.38-.272-.706-.641-.776l-.796-1.93c.21-.051.428-.077.648-.077 1.534 0 2.782 1.249 2.782 2.783 0 1.534-1.248 2.782-2.782 2.782zm0-6.429c-.333 0-.663.045-.98.134l-1.232-2.991h-1.717c-.242 0-.432.2-.432.432 0 .238.194.433.432.433h1.133l.237.564h-4.469l-.266-.564h.145c.243 0 .432-.198.432-.433 0-.239-.193-.432-.432-.432h-1.78c-.115 0-.224.045-.305.126-.082.082-.127.191-.127.306 0 .238.194.433.432.433h.683l.294.641-.797 1.572c-.399-.147-.82-.221-1.251-.221-2.011 0-3.646 1.636-3.646 3.647 0 2.01 1.635 3.646 3.646 3.646 1.86 0 3.405-1.377 3.621-3.214h1.216l3.15-4.174.232.56c-1.153.647-1.865 1.859-1.865 3.182 0 2.01 1.635 3.646 3.646 3.646s3.646-1.636 3.646-3.646c0-2.011-1.635-3.647-3.646-3.647z"

bicicleta <-"path://M8.141 11.624l-.653-.519c-.395-.312-.477-.878-.187-1.291l2.474-3.519c.237-.337.7-.42 1.04-.186l4.185 2.884h1.5c.31 0 .5.259.5.5 0 .276-.224.5-.5.5h-.728l1.3 2.393c.593-.248 1.244-.386 1.928-.386 2.76 0 5 2.24 5 5s-2.24 5-5 5-5-2.24-5-5c0-1.72.87-3.237 2.193-4.138l-1.563-2.877-2.541-.782-.872 1.309 2.287 2.948c.179.231.216.535.122.811-.338.994-1.201 3.429-1.567 4.398-.09.244-.351.38-.604.316l-.023-.006c-.286-.071-.46-.347-.42-.637.156-1.159.573-3.986.573-3.986l-2.659-2.109-.674.957c1.07.917 1.748 2.277 1.748 3.796 0 2.76-2.24 5-5 5s-5-2.24-5-5 2.24-5 5-5c.883 0 1.712.229 2.433.632l.708-1.008zm-1.288 1.831c-.554-.291-1.185-.455-1.853-.455-2.208 0-4 1.792-4 4s1.792 4 4 4c2.207 0 4-1.792 4-4 0-1.18-.512-2.241-1.326-2.974l-1.779 2.529c.067.133.105.285.105.445 0 .552-.448 1-1 1s-1-.448-1-1 .448-1 1-1l.061.002 1.792-2.547zm9.821.292c-1.014.726-1.674 1.913-1.674 3.253 0 2.208 1.792 4 4 4s4-1.792 4-4-1.792-4-4-4c-.511 0-.998.096-1.447.27l1.483 2.731c.535.019.964.459.964.999 0 .552-.448 1-1 1s-1-.448-1-1c0-.194.056-.377.152-.53l-1.478-2.723zm-3.597-11.747c1.147 0 2.077.931 2.077 2.077 0 1.147-.93 2.077-2.077 2.077-1.146 0-2.077-.93-2.077-2.077 0-1.146.931-2.077 2.077-2.077z/></svg>"

carro <- "path://M11 11v-3h1.247c.882 0 1.235.297 1.828.909.452.465 1.925 2.091 1.925 2.091h-5zm-1-3h-2.243c-.688 0-1.051.222-1.377.581-.316.348-.895.948-1.506 1.671 1.719.644 4.055.748 5.126.748v-3zm14 5.161c0-2.823-2.03-3.41-2.794-3.631-1.142-.331-1.654-.475-3.031-.794-.55-.545-2.052-2.036-2.389-2.376l-.089-.091c-.666-.679-1.421-1.269-3.172-1.269h-7.64c-.547 0-.791.456-.254.944-.534.462-1.944 1.706-2.34 2.108-1.384 1.402-2.291 2.48-2.291 4.603 0 2.461 1.361 4.258 3.179 4.332.41 1.169 1.512 2.013 2.821 2.013 1.304 0 2.403-.838 2.816-2h6.367c.413 1.162 1.512 2 2.816 2 1.308 0 2.409-.843 2.82-2.01 1.934-.056 3.181-1.505 3.181-3.829zm-18 4.039c-.662 0-1.2-.538-1.2-1.2s.538-1.2 1.2-1.2 1.2.538 1.2 1.2-.538 1.2-1.2 1.2zm12 0c-.662 0-1.2-.538-1.2-1.2s.538-1.2 1.2-1.2 1.2.538 1.2 1.2-.538 1.2-1.2 1.2zm2.832-2.15c-.399-1.188-1.509-2.05-2.832-2.05-1.327 0-2.44.868-2.836 2.062h-6.328c-.396-1.194-1.509-2.062-2.836-2.062-1.319 0-2.426.857-2.829 2.04-.586-.114-1.171-1.037-1.171-2.385 0-1.335.47-1.938 1.714-3.199.725-.735 1.31-1.209 2.263-2.026.34-.291.774-.432 1.222-.43h5.173c1.22 0 1.577.385 2.116.892.419.393 2.682 2.665 2.682 2.665s2.303.554 3.48.895c.84.243 1.35.479 1.35 1.71 0 1.196-.396 1.826-1.168 1.888z"
      
bici <- data.frame(
x=c("Belém", "Ananindeua", "Parauapebas", "Marabá", "Altamira", "Santarém", "Castanhal", "Redenção", "Itaituba", "Marituba", "Paragominas", "Canaão", "Barcarena", "Xinguara", "Bragança", "Benevides"),
y=c("47", "46", "45", "37", "35", "35", "33", "31", "30", "28", "25", "25", "24", "23", "19", "17"))
      
      bici %>%
        e_charts(x) %>%
        e_pictorial(y, symbol=carro,
                    symbolRepeat = TRUE,
                    symbolSize = c(20,20))%>% 
        e_theme("blue") %>%
        e_title("Vítima Fatal p/Acidentes de Trânsito, segundo Colissão entre Veículos", 
                left='center') %>%
        e_color(color='black') %>%
        e_flip_coords() %>%
        e_legend(show=FALSE) %>%
        e_x_axis(splitLine=list(show=F)) %>%
        e_y_axis(splitLine=list(show=T)) %>%
        e_labels(fontSize=15, 
                 fontWeight='bold', 
                 position="right", 
                 offset=c(5, 0), 
                 color= "red")%>%
        e_tooltip()%>%
        e_animation(duration = 3000) 
    })

##########################################################################################
    
  })
}


#Play do Módulo
ui <- dashboardPage(header = dashboardHeader(),
                    title = "Pictogramas de Sinistros",
                    sidebar = dashboardSidebar(),
                    body = dashboardBody(fluidPage(pictogramas_ui("pictogramas"))))

server <- function(input, output) {
  pictogramas_Server("pictogramas")
}

shinyApp(ui, server)
